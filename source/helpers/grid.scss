// GRID
// Generate bespoke grids.
// -----------------------------------------------------------------------------

@use "../settings" as *;
@use "../helpers/breakpoint" as *;

// Use as argument a grid definition established via layout settings.
@mixin grid($grid-definition) {
  display: grid;

  @each $breakpoint-name, $grid-properties in $grid-definition {
    @include breakpoint($breakpoint-name) {
      // Establish a grid namespace. Remove the period from the parent selector
      // so that the resulting string can be used inside class names.
      $grid-namespace: str-slice(#{&}, 2);
      // Provide a breakpoint prefix only if the argument is a breakpoint name
      // established via viewport settings.
      $breakpoint-prefix: if(
        $breakpoint-name != "default",
        #{$breakpoint-name}\:,
        null
      );
      $column-count: nth($grid-properties, 1);
      $gap-size: nth($grid-properties, 2);

      grid-template-columns: repeat($column-count, 1fr);
      grid-gap: $gap-size;

      @for $i from 1 through $column-count {
        @at-root .#{$breakpoint-prefix}#{$grid-namespace}__column-#{$i} {
          grid-column: span #{$i};
        }
      }
    }
  }
}
